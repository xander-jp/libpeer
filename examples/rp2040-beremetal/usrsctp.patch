diff --git a/usrsctplib/user_environment.c b/usrsctplib/user_environment.c
index 3deb3ef..3b339d0 100755
--- a/usrsctplib/user_environment.c
+++ b/usrsctplib/user_environment.c
@@ -374,6 +374,38 @@ read_random(void *buf, size_t size)
 	return;
 }
 
+void
+finish_random(void)
+{
+	return;
+}
+#elif defined(__RP2040_BM__)
+// RP2040 bare metal - use Pico SDK hardware RNG
+#include "pico/rand.h"
+
+void
+init_random(void)
+{
+	return;
+}
+
+void
+read_random(void *buf, size_t size)
+{
+	uint8_t *p = (uint8_t *)buf;
+	while (size >= 4) {
+		uint32_t r = get_rand_32();
+		memcpy(p, &r, 4);
+		p += 4;
+		size -= 4;
+	}
+	if (size > 0) {
+		uint32_t r = get_rand_32();
+		memcpy(p, &r, size);
+	}
+	return;
+}
+
 void
 finish_random(void)
 {
diff --git a/usrsctplib/usrsctp.h b/usrsctplib/usrsctp.h
index e0c17c3..34ad402 100644
--- a/usrsctplib/usrsctp.h
+++ b/usrsctplib/usrsctp.h
@@ -43,6 +43,9 @@ extern "C" {
 #endif
 #include <winsock2.h>
 #include <ws2tcpip.h>
+#elif defined(CONFIG_USE_LWIP)
+#include <lwip/sockets.h>
+#include <lwip/inet.h>
 #else
 #include <sys/socket.h>
 #include <netinet/in.h>
